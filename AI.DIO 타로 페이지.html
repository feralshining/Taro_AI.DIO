<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>짝사랑 속마음 타로 리더</title>
  <style>
    body {
      font-family: "Nanum Gothic", sans-serif;
      background: linear-gradient(to bottom, #000035 0%, #4A437F 70%, #5C4DA0 100%);
      min-height: 100vh;
      margin: 0;
      padding: 20px;
      color: #FAFAFF;
      text-align: center;
      overflow-x: hidden;
    }
    .container_tarot {
      max-width: 900px;
      margin: 0 auto;
      background: #ffffff0f;
      padding: 40px;
      border-radius: 20px;
      box-shadow: 0 0 20px rgba(250, 250, 255, 0.1);
    }
    h2 {
      color: #FAFAFF;
      font-size: 28px;
      margin-bottom: 10px;
    }
    p.guide {
      color: #ccc;
      margin-bottom: 30px;
      font-size: 18px;
    }
    .tarot_area {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 12px;
    }
    .taroChoiceImg {
      perspective: 1000px;
    }
    .taroChoiceImg-inner {
      width: 90px;
      height: 140px;
      position: relative;
      transform-style: preserve-3d;
      transition: transform 0.8s ease;
    }
    .taroChoiceImg.selected .taroChoiceImg-inner {
      transform: rotateY(180deg);
    }
    .card-face {
      position: absolute;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      backface-visibility: hidden;
    }
    .card-back {
      background-image: url('https://img.daily.co.kr/www.daily.co.kr/unse/tarot/card_back_tarotheart.png?v=1&CDN=1');
      background-size: cover;
    }
    .card-front {
      background-color: #FAFAFF;
      transform: rotateY(180deg);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      font-weight: bold;
      color: #000035;
      border: 2px solid #aaa;
    }
    .btns {
      margin-top: 30px;
    }
    .btns input {
      padding: 12px 30px;
      font-size: 16px;
      border: none;
      border-radius: 8px;
      background: #FAFAFF;
      color: #000035;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(255, 255, 255, 0.2);
    }
    #tarot_result {
      margin-top: 40px;
      display: none;
      animation: fadeIn 1s ease forwards;
      background: #ffffff0f;
      padding: 30px;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(250,250,255,0.1);
      text-align: left;
    }
    #tarot_result dt {
      font-weight: bold;
      margin-top: 20px;
      color: #FAFAFF;
    }
    #tarot_result dd {
      margin: 10px 0 20px;
      line-height: 1.6;
      color: #FAFAFF;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <section class="container_tarot">
    <h2>💜 짝사랑 속마음 타로 리딩 💜</h2>
    <p class="guide">짝사랑 중인 상대방을 떠올리며<br><strong>가장 끌리는 카드 3장</strong>을 선택해보세요.</p>

    <div class="tarot_area" id="taroChoice"></div>

    <div class="btns">
      <input type="button" value="다시 섞기 🔄" onclick="shuffle()">
    </div>

    <dl id="tarot_result">
      <dt>🌙 상대방의 마음 한 조각</dt>
      <dd id="rtarot_cons"></dd>
      <dt>🖼️ 이미지 속 장면이 전하는 분위기</dt>
      <dd id="rtarot_story"></dd>
      <dt>📚 카드의 상징</dt>
      <dd id="rtarot_define"></dd>
      <dt>✨ 마음을 읽는 키워드</dt>
      <dd id="rtarot_keyword"></dd>
    </dl>

    <script>
      const meanings = {
        1: { cons: "상대는 당신에게 호기심을 가지고 있어요.", story: "새로운 관계의 가능성을 탐색 중입니다.", define: "순수한 시작", keyword: "호기심, 가능성, 새출발" },
        2: { cons: "상대는 조용히 당신을 지켜보고 있습니다.", story: "감정을 쉽게 드러내지 않지만, 내면엔 관심이 있습니다.", define: "침묵 속 집중", keyword: "관찰, 인내, 분석" },
        3: { cons: "상대는 당신과의 관계에서 성장을 기대하고 있습니다.", story: "함께라면 더 큰 무언가를 만들 수 있을 거라 생각해요.", define: "창조적 협력", keyword: "확장, 소통, 이상향" },
        4: { cons: "상대는 감정을 단단히 숨기고 있어요.", story: "불안보단 안정이 우선인 사람이에요.", define: "통제와 안정", keyword: "보수성, 자기방어, 거리두기" },
        5: { cons: "상대는 전통적인 방식의 관계를 선호합니다.", story: "혼란스러운 감정보단, 명확한 역할을 중시해요.", define: "질서와 규범", keyword: "책임감, 명확함, 신중함" },
        6: { cons: "상대는 당신과의 조화를 상상하고 있어요.", story: "감정의 교류가 이미 시작되었어요.", define: "감정적 균형", keyword: "조화, 이해, 교감" },
        7: { cons: "상대는 지금 감정보단 목표에 집중 중입니다.", story: "당신은 그 여정의 한 장면일 수 있어요.", define: "의지와 추진력", keyword: "전진, 집중, 거리" },
        8: { cons: "상대는 내면의 갈등으로 혼란스러워요.", story: "감정의 균형이 아직 잡히지 않았습니다.", define: "용기와 자기극복", keyword: "내면투쟁, 조절, 회복중" },
        9: { cons: "상대는 현재 자신만의 시간을 필요로 해요.", story: "관계보다 자아에 집중하고 있어요.", define: "고독 속 성찰", keyword: "거리두기, 숙고, 회피" },
        10: { cons: "관계에 큰 전환점이 다가오고 있어요.", story: "운명의 수레바퀴가 움직입니다.", define: "예상치 못한 변화", keyword: "기회, 전환, 우연" },
        11: { cons: "상대는 감정보단 이성적으로 관계를 보고 있어요.", story: "공평한 판단 속에 감정을 숨기고 있어요.", define: "균형과 공정성", keyword: "이성, 정의, 판단" },
        12: { cons: "상대는 지금 마음을 멈추고 상황을 관망 중이에요.", story: "당신을 어떻게 대할지 고민하고 있어요.", define: "수동적 희생", keyword: "정체, 인내, 고려중" },
        13: { cons: "상대의 감정은 끝났을 수도 있어요.", story: "하지만 새로운 관계로의 가능성도 있어요.", define: "종말과 재탄생", keyword: "변화, 종료, 새출발" },
        14: { cons: "감정을 조심스럽게 조율하고 있어요.", story: "지금은 천천히 다가가는 중입니다.", define: "조화로운 흐름", keyword: "인내, 조절, 부드러움" },
        15: { cons: "상대는 욕망이나 집착에 흔들리고 있어요.", story: "감정이 순수하지 않을 수 있어요.", define: "속박과 유혹", keyword: "집착, 미련, 불안정" },
        16: { cons: "예기치 못한 상황으로 마음이 무너졌습니다.", story: "지금은 상처 회복의 시기예요.", define: "붕괴와 재정비", keyword: "상실, 재구성, 충격" },
        17: { cons: "당신에게 희망을 걸고 있어요.", story: "서서히 마음이 열리고 있습니다.", define: "희망의 징조", keyword: "빛, 기대, 긍정" },
        18: { cons: "감정이 혼란스럽고 명확하지 않아요.", story: "진심이 무엇인지 스스로도 헷갈려요.", define: "환상과 불확실성", keyword: "혼돈, 의심, 직관" },
        19: { cons: "상대는 당신과의 밝은 미래를 꿈꾸고 있어요.", story: "함께할 수 있다는 기대가 커지고 있어요.", define: "성취와 따뜻함", keyword: "열정, 긍정, 공감" },
        20: { cons: "과거를 돌아보며 마음을 정리 중입니다.", story: "새로운 기회에 대한 가능성을 열어두고 있어요.", define: "부활과 반성", keyword: "회상, 기회, 용서" },
        21: { cons: "당신은 상대에게 완성된 사람처럼 보여요.", story: "그는 당신과의 관계에 큰 의미를 둡니다.", define: "완성된 조화", keyword: "결실, 감탄, 안정" },
        22: { cons: "상대는 예측 불가한 태도를 보일 수 있어요.", story: "감정의 방향이 어디로 튈지 몰라요.", define: "자유와 가능성", keyword: "즉흥성, 낙관, 예외성" }
      };

      const area = document.getElementById("taroChoice");
      for (let i = 1; i <= 22; i++) {
        const div = document.createElement("div");
        div.className = "taroChoiceImg";
        div.setAttribute("data-id", i);

        const inner = document.createElement("div");
        inner.className = "taroChoiceImg-inner";

        const back = document.createElement("div");
        back.className = "card-face card-back";

        const front = document.createElement("div");
        front.className = "card-face card-front";
        front.innerText = i;

        inner.appendChild(back);
        inner.appendChild(front);
        div.appendChild(inner);
        area.appendChild(div);
      }

      let selected = [];

      function createCards() {
        const area = document.getElementById("taroChoice");
        area.innerHTML = "";
        const ids = [...Array(22).keys()].map(i => i + 1).sort(() => Math.random() - 0.5);

        ids.forEach(i => {
          const div = document.createElement("div");
          div.className = "taroChoiceImg";
          div.setAttribute("data-id", i);

          const inner = document.createElement("div");
          inner.className = "taroChoiceImg-inner";

          const back = document.createElement("div");
          back.className = "card-face card-back";

          const front = document.createElement("div");
          front.className = "card-face card-front";
          front.innerText = i;

          inner.appendChild(back);
          inner.appendChild(front);
          div.appendChild(inner);
          area.appendChild(div);

          // ✅ 여기서 이벤트 리스너 바로 등록
          div.addEventListener('click', () => {
            const id = parseInt(div.getAttribute('data-id'));
            if (selected.length >= 3 || selected.includes(id)) return;
            selected.push(id);
            div.classList.add('selected');

            if (selected.length === 3) {
              const last = selected[selected.length - 1];
              const result = meanings[last] || {};
              setTimeout(() => {
                document.getElementById('rtarot_cons').innerText = result.cons || '';
                document.getElementById('rtarot_story').innerText = result.story || '';
                document.getElementById('rtarot_define').innerText = result.define || '';
                document.getElementById('rtarot_keyword').innerText = result.keyword || '';
                document.getElementById('tarot_result').style.display = 'block';
              }, 1000);
            }
          });
        });
      }


      document.querySelectorAll('.taroChoiceImg').forEach(card => {
        card.addEventListener('click', () => {
          const id = parseInt(card.getAttribute('data-id'));
          if (selected.length >= 3 || selected.includes(id)) return;
          selected.push(id);
          card.classList.add('selected');

          if (selected.length === 3) {
            const last = selected[selected.length - 1];
            const result = meanings[last] || {};
            setTimeout(() => {
              document.getElementById('rtarot_cons').innerText = result.cons || '상대방의 마음을 감지할 수 없습니다';
              document.getElementById('rtarot_story').innerText = result.story || '';
              document.getElementById('rtarot_define').innerText = result.define || '';
              document.getElementById('rtarot_keyword').innerText = result.keyword || '';
              document.getElementById('tarot_result').style.display = 'block';
            }, 1000);
          }
        });
      });

      function shuffle() {
        selected = [];
        document.getElementById('tarot_result').style.display = 'none';
        createCards();
      }
      window.onload = createCards();
    </script>
  </section>
</body>
</html>